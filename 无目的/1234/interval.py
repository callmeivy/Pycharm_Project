# coding=UTF-8
import pymongo
conn=pymongo.Connection('172.16.168.45',27017)
print  "connected"
iae_hitlog_new=conn.gehua.iae_hitlog_new
print 0
index = iae_hitlog_new.create_index("date")
# lines=iae_hitlog_new.find({"date":{"$gt":1411488000000,"$lt":1411574399999}})
# iplist=[]
# for line in lines:
#     ip=line["ip"]
#     print ip
#     if ip not in iplist:
#         iplist.append(ip)
# print iplist
##9.24 all ip list:10.188.43.56
# 172.16.80.253
# 172.16.80.253
# 10.177.30.133
# 10.168.83.239
# 10.180.6.50
# 10.176.131.253
# 10.201.28.224
# 10.190.93.0
# 10.234.157.165
# 10.217.32.196
# 10.217.24.13
# 10.242.183.235
# 172.16.70.253
# 10.231.198.58
# 10.216.82.200
# 10.206.151.208
# 10.213.101.224
# 10.211.211.245
# 10.180.6.50
# 10.229.229.46
# 10.169.205.216
# 10.205.23.31
# 10.228.217.92
# 10.195.8.139
# 10.198.207.220
# 10.195.23.39
# 10.219.87.159
# 10.215.185.92
# 172.16.70.253
# 10.211.211.245
# 10.195.23.39
# 10.206.151.208
# 10.198.207.220
# 10.213.101.224
# 10.219.87.159
# 10.195.8.139
# 10.190.93.0
# 10.176.131.253
# 172.16.64.253
# 10.254.163.20
# 172.16.64.253
# 10.213.13.229
# 172.16.64.252
# 172.16.64.252
# 10.195.23.39
# 10.219.87.159
# 10.195.8.139
# 10.198.207.220
# 10.206.151.208
# 10.213.101.224
# 10.211.211.245
# 10.213.13.229
# 10.237.249.87
# 10.242.41.159
# 10.219.40.122
# 10.213.147.236
# 10.207.12.139
# 10.207.12.139
# 10.238.176.75
# 10.192.106.43
# 10.198.204.80
# 10.213.147.236
# 10.201.38.233
# 10.207.22.142
# 10.213.64.135
# 10.168.83.239
# 10.177.30.133
# 10.190.40.107
# 10.229.229.46
# 10.199.121.116
# 10.190.40.107
# 10.187.110.26
# 10.187.160.118
# 10.187.110.26
# 10.213.13.229
# 172.16.64.252
# 172.16.64.252
# 10.213.13.229
# 10.237.249.87
# 10.242.41.159
# 10.215.171.91
# 10.212.72.236
# 172.16.65.253
# 172.16.65.253
# 10.215.6.203
# 10.240.45.83
# 10.240.45.83
# 10.225.52.155
# 172.16.68.252
# 172.16.68.252
# 10.238.33.210
# 10.205.158.183
# 10.208.9.73
# 10.222.116.90
# 172.16.67.253
# 172.16.67.253
# 10.199.64.126
# 10.208.69.176
# 10.188.48.30
# 10.187.205.69


# index2 = iae_hitlog_new.create_index("ip")
# ips=iae_hitlog_new.distinct("ip")
# for ip in ips:

#10.187.205.69,10.199.64.126,10.169.188.210,10.187.35.209,10.164.225.247,10.187.250.92
lines=iae_hitlog_new.find({"ip":"10.169.188.210","$or":[{"previous.action.rp2":"toPlayBundle.do"},{"resource.action.rp2":'toPlayPackAsset.do'}]}).sort("date",pymongo.DESCENDING).batch_size(30)
starttime=lines[0]["date"]
# print starttime
for line in lines:
    # print line["date"]
    # print line["ip"]
    dateToEmpty=line["date"]
    # print dateToEmpty
    interval=dateToEmpty-starttime
    starttime=dateToEmpty

    print interval






conn.close()
